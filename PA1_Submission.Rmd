---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data
```{r downloadandread, echo=TRUE}
setwd("~/GitHub/RepData_PeerAssessment1")
data <- read.csv("activity.csv")

data$date <- as.POSIXct(strptime(data$date,'%Y-%m-%d'))
```


## What is mean total number of steps taken per day?
``` {r}
library(dplyr, quietly=TRUE)
daily_steps <- data %>% filter(!is.na(steps)) %>% 
	group_by(date) %>% 
	summarize(total = sum(steps))
mean_steps <- round(mean(daily_steps$total),0)
median_steps <- round(median(daily_steps$total),0)
plot(x=daily_steps$date, y=daily_steps$total,type="h",col=4, xlab="Date", ylab="No. of Steps", main="Total Number of Stpes Taken Each Day")

```

- The mean total number of steps taken per day is :`r as.integer(mean_steps)`
- The median total number of steps taken per day is :`r as.integer(median_steps)`

## What is the average daily activity pattern?
``` {r }
interval_steps <- data %>%  
	filter(!is.na(steps)) %>%  
	group_by(interval) %>%  
	summarize(ave_steps = mean(steps))  
max_steps_interval <- max(interval_steps$ave_steps)  

int_w_max <- interval_steps %>%  
	     filter(ave_steps == max_steps_interval) %>%  
	    select(interval)

plot(x=interval_steps$interval, y=as.integer(interval_steps$ave_steps), 
     type="l", col=4, xlab="5 min intervals in a day",
        ylab = "Average number of steps",
        main = "Average number of steps across all days")

int_w_max <- interval_steps %>% 
	     filter(ave_steps == max_steps_interval)


```

The interval that contains the maximum number of steps is: `r int_w_max$interval` 

## Imputing missing values

```{r}
num_rows_with_NA <- as.integer(data %>% filter(is.na(steps)) %>% count)
```
Number of rows with missing values = `r num_rows_with_NA`

```{r }
na_rows_filled <- data %>% filter(is.na(steps)) %>% 
     merge(interval_steps, interval.x = interval.y) %>% 
     mutate( steps = round(ave_steps,1)) %>%
     select (steps, date, interval) 


non_na_rows <- data %>% filter(!is.na(steps)) 
all_rows_filled <- bind_rows(non_na_rows, na_rows_filled)
summary(all_rows_filled)

daily_steps_filled <- all_rows_filled %>% filter(!is.na(steps)) %>% 
	group_by(date) %>% 
	summarize(total = sum(steps))
mean_steps_filled <- round(mean(daily_steps_filled$total),0)
median_steps_filled <- median(daily_steps_filled$total)
plot(x=daily_steps_filled$date, y=daily_steps_filled$total,type="h",col=4, xlab="Date", ylab="No. of Steps", main="Total Number of Stpes Taken Each Day")

summary(daily_steps);
summary(daily_steps_filled)
```

The mean is the same becuase the missing values were filled with the mean. The median sees a small change.

## Are there differences in activity patterns between weekdays and weekends?
